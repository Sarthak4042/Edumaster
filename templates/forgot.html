<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>forgot_password</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/assets/css/styles.min.css">
    <script src="https://smtpjs.com/v3/smtp.js"></script>
</head>

<body><!-- Start: ♣ Login form Page BS4 ♣ -->
    <div class="container-fluid">
        <div class="row mh-100vh"><!-- Start: Login block -->
            <div class="col-10 col-sm-8 col-md-6 col-lg-6 offset-1 offset-sm-2 offset-md-3 offset-lg-0 align-self-center d-lg-flex align-items-lg-center align-self-lg-stretch bg-white p-5 rounded rounded-lg-0 my-5 my-lg-0"
                id="login-block"><!-- Start: Login container -->
                <div class="m-auto w-lg-75 w-xl-50"><!-- Start: Your company -->
                    <h2 class="text-info fw-light mb-5"><i class="fa fa-diamond"></i>&nbsp;EDUMASTER</h2>
                    <!-- End: Your company --><!-- Start: Login form -->
                    <form><!-- Start: Email -->
                        <div class="form-group mb-3"><label class="form-label text-secondary">Registered
                                Email</label><input id="emailInput" class="form-control" type="text" required=""
                                pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$" inputmode="email"></div>
                        <!-- End: Email --><!-- Start: Password -->
                        <button class="btn btn-info mt-2"
                            type="submit" onclick="validateEmail()">Sent Otp</button><br><br>
                        <div class="form-group mb-3"><label class="form-label text-secondary">OTP</label><input id="otpInput"
                                class="form-control" type="password" required=""></div>
                        <!-- End: Password --><!-- Start: Submit --><button class="btn btn-info mt-2" onclick="reset(event)"
                            type="submit">Reset Password</button><!-- End: Submit -->
                    </form><!-- End: Login form --><!-- Start: Forgot password -->
                    <p class="mt-3 mb-0"></p><!-- End: Forgot password -->
                </div><!-- End: Login container -->
            </div><!-- End: Login block --><!-- Start: Background image -->
            <div class="col-lg-6 d-flex align-items-end" id="bg-block"
                style="background-image: url(&quot;/static/assets/img/logo-white.jpg?h=54082e122040948a0f9b1a9485f12f6a&quot;);background-size: cover;background-position: center center;">
                <!-- Start: Credit photo -->
                <p class="ms-auto small text-dark mb-2"><em>&nbsp;</em></p><!-- End: Credit photo -->
            </div><!-- End: Background image -->
        </div>
    </div><!-- End: ♣ Login form Page BS4 ♣ -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    function generateOTP() {
        const otpLength = 6;
        return Math.floor(100000 + Math.random() * 900000);
    }

    // Function to send email
    function sendEmail(toEmail, otp) {
        Email.send({
        Host: "smtp.elasticemail.com",
        Username: "edumaster.apsit@gmail.com",
        Password: "377E0E0078018B3D3460CA38A9800144557B",
        To: toEmail,
        From: "edumaster.apsit@gmail.com",
        Subject: "OTP for Resetting Password",
        Body: `Your OTP for resetting password is: ${otp}`
    }).then(
        message => alert("Email sent.")
    );
    }

    // Function to validate email
    function validateEmail() {
    // Get the input value
        var emailInput = document.getElementById('emailInput').value;
        if (emailInput.endsWith('@apsit.edu.in')) {
            const otp = generateOTP();
            sendEmail(emailInput, otp);
            return true;
        } else {
            alert('Please enter a valid email ending with @apsit.edu.in');
            return false; // Prevent form submission
        }
    }

    function reset(event) {
        event.preventDefault();
        var otpInput = document.getElementById('otpInput').value;
        if (otpInput === otp.toString()) {
            // Prompt for setting a new password
            //var newPassword = prompt('Enter your new password:');
            alert('Password reset successfully. You can now log in with your new password.');
        } else {
            alert('Invalid OTP. Please try again.');
        }
    }

    </script>
</body>

</html>